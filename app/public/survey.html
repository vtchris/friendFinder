<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Friend Finder - Survey</title>
    <!-- BOOTSTRAP -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        .form {
            width: 500px;
            margin: auto;
        }

        label {
            display: block;
        }

        ul {
            list-style-type: none;
        }
    </style>
</head>

<body>
    <div id="wrapper">

        <form class="form">
            <h2>Tell Us A Little About Yourself!</h2>
            <hr>
            <div class="form-group">
                <input id="name-txt" class="form-control" type="text" placeholder="Name">
                <ul id="survey-ul">

                </ul>

            </div>
            <button id='submit-btn' class="btn btn-primary btn-lg">Submit</button>
        </form>

        <div class="card">
                <img id="friend-img" class="card-img-top" src="" alt="Card image cap">
                <div class="card-body">
                        <h4 id="friend-header" class="card-title"></h4>
                </div>
        </div>
    </div>

    <script type="text/javascript">
    let $friendImg = $("#friend-img");
        let $surveyUl = $("#survey-ul");
        let $friendHeader = $("#friend-header");
        let questions = ['I am outgoing', 'I like spending time outdoors', 'I like watching movies', 'I have more energy in the morning', 'I like pets (dogs and cats)', 'I prefer to text rather than call', 'I like going to concerts', 'I like to cook', 'I like to play sports', 'I like to joke around'];

        for (let i = 0; i < questions.length; i++) {
            //let li = document.createElement('li');
            let li = $("<li>")
            let label = $("<label>");
            label.text(questions[i]);
            label.appendTo(li)
            //li.append(label)

            let select = document.createElement('select');
            select.setAttribute('id', 'q' + parseInt(i + 1));
            let firstOption = document.createElement('option');
            firstOption.text = 'Select an Option';
            select.appendChild(firstOption);

            for (let j = 5; j > 0; j--) {
                let option = document.createElement('option');
                option.value = j;
                if (j === 5) {
                    option.text = j + ' (Strongly Agree)';
                } else if (j === 1) {
                    option.text = j + ' (Strongly Disagree)';
                } else {
                    option.text = j;
                }
                select.add(option);
            }

            li.append(select);
            $surveyUl.append(li);
        }

        $('#submit-btn').on('click', function (e) {
            e.preventDefault()

            var currentURL = window.location.origin;
            let friend = {};
            let responses = [];

            let answers = $('select')

            for (let i = 0; i < answers.length; i++) {
                responses.push(parseInt(answers[i].value));
            }
            friend.name = $('#name-txt').val();
            friend.responses = responses;

            //$.post(currentURL + "/api/friends", friend, function (data) {
            $.post("/api/friends", friend, function (res) {
                console.log("bye")
                console.log(res)

                $friendImg.attr("src",res.image);
                $friendHeader.text(res.name);
            })



        })

    </script>
</body>

</html>